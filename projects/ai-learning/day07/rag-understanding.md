# Day 7: RAG 理解ノート

## LLM（Large Language Model）とは

大量のテキストデータを学習して、人間のような文章を理解・生成できるAIモデル。

### 学習データ
- Web（Wikipedia、ニュース、ブログなど）
- 書籍、学術論文
- GitHub上の公開コード
- 公開された時点のデータのみ（非公開データは含まれない）

### 仕組み
1. トークン化: テキストを小さな単位に分割
2. 次のトークンを予測: 確率的に次に来る単語を選択
3. Transformerアーキテクチャ: Attention機構で文脈を理解

### モデルの違い（例: Claude）
- Opus: 最高性能、複雑な推論向け
- Sonnet: バランス型、実用的
- Haiku: 高速・軽量、シンプルなタスク向け

---

## LLM関連の重要用語

| 用語 | 説明 |
|------|------|
| プロンプト | LLMへの入力（指示・質問） |
| コンテキスト | LLMが一度に見える情報の範囲 |
| トークン | テキストの最小処理単位、料金計算の基準 |
| ハルシネーション | 事実と異なる情報をもっともらしく生成すること |
| Temperature | 出力のランダム性を制御（低=一貫性、高=創造性） |
| Fine-tuning | 特定タスク向けに追加学習（高コスト） |
| RLHF | 人間のフィードバックによる強化学習 |
| マルチモーダル | テキスト以外（画像、音声など）も扱える |

---

## LLMの課題（なぜRAGが必要か）

1. **知識のカットオフ**: 学習時点以降の情報を知らない
2. **非公開データ不明**: 社内ドキュメントなどは学習していない
3. **ハルシネーション**: 知らないことでも「それっぽく」答えてしまう

---

## RAG（Retrieval-Augmented Generation）とは

質問に関連する情報を外部から検索して、LLMに渡してから回答させる手法。

### 名前の意味
- Retrieval: 検索
- Augmented: 拡張された
- Generation: 生成

### 3つのステップ
```
① Retrieve（検索）
   質問に関連するドキュメントを検索

② Augment（拡張）
   検索結果をプロンプトに追加

③ Generate（生成）
   LLMが検索結果を参考に回答
```

---

## Embedding（埋め込み）とは

テキストをベクトル（数値のリスト）に変換する技術。
```
"有給休暇" → [0.12, -0.34, 0.56, ...]
```

### ポイント
- 意味が近いテキスト → 似たベクトルになる
- 意味が遠いテキスト → 違うベクトルになる
- Embedding自体は「変換」のみ。距離計算・検索は別の処理

### Embeddingのタイミング
1. 準備フェーズ: ドキュメントをVector DBに登録するとき
2. 検索フェーズ: ユーザーが質問するたび

---

## Vector Database（ベクトルDB）とは

ベクトルを保存し、類似ベクトルを高速に検索できるデータベース。

### 通常のDBとの違い
- 通常DB: 完全一致、範囲指定で検索
- Vector DB: 「意味の近さ」で検索（類似検索）

### 代表的なVector DB
- Pinecone: クラウドサービス
- Chroma: オープンソース、ローカル動作、学習向き
- pgvector: PostgreSQL拡張

---

## RAG全体の流れ
```
【準備フェーズ】
ドキュメント → Embedding → Vector DBに保存

【検索フェーズ】
質問 → Embedding → Vector DBで類似検索 → 関連ドキュメント取得
                                              ↓
                              プロンプトに追加してLLMに渡す
                                              ↓
                                    LLMが回答を生成
```

---

## 最新情報の取り込み方法の比較

| 方法 | コスト | リアルタイム性 |
|------|--------|----------------|
| 再学習 | 非常に高い | 低い |
| Fine-tuning | 高い | 低い |
| RAG | 低い | 高い |
| Tool Use | 低い | 高い |

---

## 次のステップ（Day 8）
- Chromaを使ったRAGの実装
- 実際にドキュメントを登録して検索する